{% extends "mini_buildd/base.html" %}
{% load base %}

{% block mbd_page_title %} - repository {{ object.identity }}{% endblock %}
{% block mbd_page_footer %} &raquo; {{ object.identity }}{% endblock %}

{% block content %}

	<div id="mb_repository">
		<div class="box">
			<h1 class="box-caption">Repository: {{ object.identity }}</h1>

			{% if object.external_home_url %}
				<div id="mb_repository_misc">
					<ul>
						<li>External documentation: <a href="{{ object.external_home_url }}">{{ object.external_home_url }}</a></li>
					</ul>
				</div>
			{% endif %}

			<div id="mb_repository_search">
				<div class="inner-box">
					<h1 class="inner-box-caption">Search</h1>

					<form id="mb_repository_search_form" action="/mini_buildd/repositories/" method="get">
						<table>
							<tr>
								<th>Package Name</th>
								<th>Distribution</th>
								<th />
							</tr>
							<tr>
								<td>
									<input type="hidden" name="repository" value="{{ object.identity|urlencode }}" />
									<input type="text" name="package" size="80" title="Please enter a package name pattern (shell-like glob)." class="package-input" />
									<input type="hidden" name="action" value="search" />
								</td>
								<td><select name="codename" size="1">
										{% for d in object.distributions.all %}
											<option value="{{ d.base_source.codename|urlencode }}">{{ d }}</option>
										{% endfor %}
										<option selected="selected" value="">any</option>
								</select></td>
								<td class="form-submit"><input title="Search for package!" type="submit" value="Search" /></td>
							</tr>
						</table>
					</form>

				</div>
			</div>

			{% for d in object.distributions.all %}
				<div class="inner-box">
					<h1 class="inner-box-caption">Distribution: {{ d }}</h1>
					<h2>Architectures</h2>
					<ul>
						{% for a in d.architectureoption_set.all  %}
							<li>{{ a.architecture.name }}
								{% if a.optional %}
									(o)
								{% endif %}
							</li>
						{% endfor %}
					</ul>
					<hr />
					{% for s in object.layout.suiteoption_set.all %}
						<h2>{{ d.base_source.codename }}-{{ object.identity }}-{{ s.suite.name }}: <span class="emphasize-headline">{% repository_desc object d s %}</span></h2>
						<ul>
							<li>Apt source line: <pre class="pre-inline">{% distribution_apt_line d object s %}</pre></li>
							<li>Mandatory version part: <pre class="pre-inline">{% repository_mandatory_version object d s %}</pre></li>
							{% if s.suite.migrates_to %}
								<li>Migrates to: <span class="emphasize-migrates-from">{{ s.suite.migrates_to.name }}</span></li>
							{% endif %}
							{% if s.uploadable %}
								<li>Uploadable.</li>
								<li>Apt sources.list:<div class="pre-block"><pre>{% distribution_apt_sources_list d object s %}</pre></div></li>
								<li>Apt preferences:<div class="pre-block"><pre>{% distribution_apt_preferences d object s %}</pre></div></li>
							{% endif %}
						</ul>
					{% endfor %}
				</div>
			{% endfor %}

		</div>
	</div>


{% endblock %}
