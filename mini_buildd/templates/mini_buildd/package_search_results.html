{% extends "mini_buildd/base.html" %}
{% load base %}

{% block mbd_page_title %} - search results{% endblock %}
{% block mbd_page_footer %} &raquo; <a href="/mini_buildd/repositories/">repositories</a> &raquo; search results{% endblock %}


{% block content %}

<div id="mb_package_search_results">
	<div class="box">
		<h1 class="box-caption">Search results</h1>

		{% if result %}
		{% for repository, packages in result.items %}
		<div class="box">
			<h1 class="box-caption"><a href="/mini_buildd/repositories/{{ repository }}/">Repository: {{ repository }}</a></h1>

			{% for package, versions in packages.items %}

			<div class="inner-box">
				<h1 class="inner-box-caption">Source package: {{ package }}</h1>

				<table>
					<tr>
						<th>Version</th>
						<th>Distribution</th>
						<th>Propagation</th>
					</tr>

					{% for version, properties in versions.items %}

					<tr>
						<td>{{ version }}</td>
						<td>{{ properties.distribution }}</td>
						{% if properties.migrates_to %}
						{% if authenticated %}
						<td><a class="propagate" title="to: {{ properties.migrates_to }}"
									 href="/mini_buildd/repositories/?action=propagate&amp;package={{ package|urlencode }}&amp;version={{ version|urlencode }}&amp;repository={{ repository|urlencode }}&amp;from_distribution={{ properties.distribution|urlencode }}&amp;to_distribution={{ properties.migrates_to|urlencode }}">propagate</a></td>
						{% else %}
						<td><a class="propagate" title="You need superuser rights!" href="/admin/">log in to propagate</a></td>
						{% endif %}
						{% else %}
						<td class="search-result-cannot-propagate">not possible</td>
						{% endif %}
					</tr>
					{% endfor %}
				</table>
			</div>
			{% endfor %}
			{% endfor %}
			{% else %}
			<ul>
				<li><span class="alert">No packages found!</span></li>
				<li>Back to <a href="javascript: history.back()">search</a>.</li>
			</ul>
			{% endif %}
		</div>
	</div>
</div>

{% endblock %}
